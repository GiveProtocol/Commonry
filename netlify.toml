[build]
  command = "rm -rf node_modules && npm ci && npm run build"
  publish = "dist"

[build.environment]
  NODE_VERSION = "22"
  NPM_VERSION = "10"
  # Force cache clear
  NETLIFY_CACHE_ID = "v4"

# Use npm ci to ensure clean installs from package-lock.json
[context.production]
  command = "rm -rf node_modules && npm ci && npm run build"

[context.deploy-preview]
  command = "rm -rf node_modules && npm ci && npm run build"

[context.branch-deploy]
  command = "rm -rf node_modules && npm ci && npm run build"
